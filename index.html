<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suivi Certifications Coursera - ITBS</title>
<style>
* {margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
body {background:#f5f7fa; color:#333; line-height:1.6; padding:20px; max-width:1200px; margin:auto;}
.container {background:#fff; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.08); padding:30px; margin-bottom:30px;}
.header {border-bottom:2px solid #2c3e50; padding-bottom:20px; margin-bottom:30px; text-align:center;}
.header h1 {color:#2c3e50; font-size:28px; margin-bottom:10px;}
.header h2 {color:#3498db; font-size:20px; font-weight:normal; margin-bottom:15px;}
.instructions {background:#f8f9fa; border-left:4px solid #3498db; padding:20px; margin-bottom:30px; border-radius:0 8px 8px 0;}
.instructions h3 {color:#2c3e50; margin-bottom:10px;}
.instructions ul {padding-left:20px;}
.instructions li {margin-bottom:8px;}
.info-section {display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:20px; margin-bottom:30px;}
.info-card {background:#f8f9fa; padding:15px; border-radius:8px; border:1px solid #e9ecef;}
.info-card h3 {color:#2c3e50; font-size:16px; margin-bottom:10px; border-bottom:1px solid #dee2e6; padding-bottom:5px;}
.info-card p {margin-bottom:5px;}
table {width:100%; border-collapse:collapse; margin-top:20px; margin-bottom:30px; box-shadow:0 0 10px rgba(0,0,0,0.05);}
th {background:#2c3e50; color:white; font-weight:600; text-align:left; padding:12px 15px;}
td {padding:10px 15px; border-bottom:1px solid #e9ecef;}
tr:nth-child(even){background:#f8f9fa;}
tr:hover{background:#f1f5fd;}
input, select, textarea{width:100%; padding:8px; border:1px solid #ced4da; border-radius:4px; font-size:14px;}
textarea{min-height:60px; resize:vertical;}
.btn-container{display:flex; justify-content:center; gap:15px; margin-top:20px;}
button{padding:12px 25px; border:none; border-radius:5px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s ease;}
#sendBtn{background:#3498db; color:white;}
#sendBtn:hover{background:#2980b9;}
#resetBtn{background:#e74c3c; color:white;}
#resetBtn:hover{background:#c0392b;}
.footer{text-align:center; margin-top:30px; padding-top:20px; border-top:1px solid #dee2e6; color:#6c757d; font-size:14px;}
.status-select{font-weight:600;}
.status-obtenu{color:#27ae60;}
.status-encours{color:#f39c12;}
.status-nonobtenu{color:#e74c3c;}
@media print{button, .btn-container{display:none;} .container{box-shadow:none;}}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Ecole Supérieure Privée des Technologies de l’Information et de Management de Nabeul</h1>
        <h2>ITBS - Département des Sciences de Gestion</h2>
        <p><strong>État de suivi des certifications Coursera</strong></p>
        <p>Année académique : 2025-2026</p>
    </div>

    <div class="instructions">
        <h3>Instructions pour le remplissage :</h3>
        <ul>
            <li>Remplir toutes les colonnes</li>
            <li><strong>Niveau :</strong> L1, L2, L3, M1, M2, etc.</li>
            <li><strong>Filière/Groupe :</strong> selon l'organisation pédagogique</li>
            <li><strong>Intitulé du cours Coursera :</strong> nom exact du cours</li>
            <li><strong>Causes de non-obtention :</strong> problèmes techniques, difficultés, absence de remise, etc.</li>
            <li><strong>Actions préconisées :</strong> accompagnement, rappel deadlines, tutorat, etc.</li>
        </ul>
    </div>

    <div class="info-section">
        <div class="info-card">
            <h3>Enseignant responsable</h3>
            <p><strong>Nom :</strong> [Nom du responsable]</p>
            <p><strong>Email :</strong> [email@itbs.ma]</p>
            <p><strong>Date de mise à jour :</strong> <span id="currentDate"></span></p>
        </div>
        <div class="info-card">
            <h3>Légende des statuts</h3>
            <p><span class="status-obtenu">■</span> Obtenu</p>
            <p><span class="status-encours">■</span> En cours</p>
            <p><span class="status-nonobtenu">■</span> Non obtenu</p>
        </div>
    </div>

    <table>
        <tr>
            <td>Nom et Prénom</td><td><input type="text" id="nom"></td>
        </tr>
        <tr>
            <td>Niveau</td><td><input type="text" id="niveau"></td>
        </tr>
        <tr>
            <td>Filière</td><td><input type="text" id="filiere"></td>
        </tr>
        <tr>
            <td>Groupe</td><td><input type="text" id="groupe"></td>
        </tr>
        <tr>
            <td>Cours Coursera</td><td><input type="text" id="cours"></td>
        </tr>
        <tr>
            <td>Statut</td>
            <td>
                <select id="statut">
                    <option value="">Sélectionner</option>
                    <option value="obtenu">Obtenu</option>
                    <option value="encours">En cours</option>
                    <option value="nonobtenu">Non obtenu</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Date d'obtention</td><td><input type="date" id="date"></td>
        </tr>
        <tr>
            <td>Causes de non-obtention</td><td><textarea id="causes"></textarea></td>
        </tr>
        <tr>
            <td>Actions préconisées</td><td><textarea id="actions"></textarea></td>
        </tr>
    </table>

    <div class="btn-container">
        <button id="sendBtn">Envoyer</button>
        <button id="resetBtn">Réinitialiser</button>
    </div>

    <div class="footer">
        <p>Merci de retourner ce document complété avant la date limite.</p>
    </div>
</div>

<script>
document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fr-FR');

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwJOypQKC1FKYhm-cDeAnJXVB31muI7wbBfPeBW9Mwpq2ABHipWPEUpA3abpBIcdUuHMA/exec";

document.getElementById('sendBtn').addEventListener('click', async ()=>{
    const data = {
        nom_prenom: document.getElementById('nom').value,
        niveau: document.getElementById('niveau').value,
        filiere: document.getElementById('filiere').value,
        groupe: document.getElementById('groupe').value,
        cours: document.getElementById('cours').value,
        statut: document.getElementById('statut').value,
        date_obtention: document.getElementById('date').value,
        causes: document.getElementById('causes').value,
        actions: document.getElementById('actions').value
    };

    try {
        const res = await fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(data),
            headers: { 'Content-Type': 'application/json' }
        });
        const json = await res.json();
        alert(json.message || "Données envoyées !");
    } catch(err){
        console.error(err);
        alert("Erreur lors de l'envoi : " + err);
    }
});

document.getElementById('resetBtn').addEventListener('click', ()=>{
    if(confirm("Voulez-vous vraiment réinitialiser le formulaire ?")){
        document.querySelectorAll('input, textarea, select').forEach(el=>{
            if(el.tagName==="SELECT") el.selectedIndex=0; else el.value="";
        });
    }
});
</script>

</body>
</html>
