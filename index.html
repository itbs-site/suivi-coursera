<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suivi Certifications Coursera - ITBS</title>
<style>
* {margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
body {background:#f5f7fa; color:#333; line-height:1.6; padding:20px; max-width:1200px; margin:auto;}
.container {background:#fff; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.08); padding:30px; margin-bottom:30px;}
.header {border-bottom:2px solid #2c3e50; padding-bottom:20px; margin-bottom:30px; text-align:center;}
.header h1 {color:#2c3e50; font-size:28px; margin-bottom:10px;}
.header h2 {color:#3498db; font-size:20px; font-weight:normal; margin-bottom:15px;}
.instructions {background:#f8f9fa; border-left:4px solid #3498db; padding:20px; margin-bottom:30px; border-radius:0 8px 8px 0;}
.instructions h3 {color:#2c3e50; margin-bottom:10px;}
.instructions ul {padding-left:20px;}
.instructions li {margin-bottom:8px;}
.info-section {display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:20px; margin-bottom:30px;}
.info-card {background:#f8f9fa; padding:15px; border-radius:8px; border:1px solid #e9ecef;}
.info-card h3 {color:#2c3e50; font-size:16px; margin-bottom:10px; border-bottom:1px solid #dee2e6; padding-bottom:5px;}
.info-card p {margin-bottom:5px;}
table {width:100%; border-collapse:collapse; margin-top:20px; margin-bottom:30px; box-shadow:0 0 10px rgba(0,0,0,0.05);}
th {background:#2c3e50; color:white; font-weight:600; text-align:left; padding:12px 15px;}
td {padding:10px 15px; border-bottom:1px solid #e9ecef;}
tr:nth-child(even){background:#f8f9fa;}
tr:hover{background:#f1f5fd;}
input, select, textarea{width:100%; padding:8px; border:1px solid #ced4da; border-radius:4px; font-size:14px;}
textarea{min-height:60px; resize:vertical;}
.btn-container{display:flex; justify-content:center; gap:15px; margin-top:20px;}
button{padding:12px 25px; border:none; border-radius:5px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s ease;}
#sendBtn{background:#3498db; color:white;}
#sendBtn:hover{background:#2980b9;}
#resetBtn{background:#e74c3c; color:white;}
#resetBtn:hover{background:#c0392b;}
.footer{text-align:center; margin-top:30px; padding-top:20px; border-top:1px solid #dee2e6; color:#6c757d; font-size:14px;}
.status-select{font-weight:600;}
.status-obtenu{color:#27ae60;}
.status-encours{color:#f39c12;}
.status-nonobtenu{color:#e74c3c;}
@media print{button, .btn-container{display:none;} .container{box-shadow:none;}}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Ecole Supérieure Privée des Technologies de l’Information et de Management de Nabeul</h1>
        <h2>ITBS - Département des Sciences de Gestion</h2>
        <p><strong>État de suivi des certifications Coursera</strong></p>
        <p>Année académique : 2025-2026</p>
    </div>

    <div class="instructions">
        <h3>Instructions pour le remplissage :</h3>
        <ul>
            <li>Remplir toutes les colonnes pour l'étudiant dont vous êtes responsable</li>
            <li><strong>Niveau :</strong> L1, L2, L3, M1, M2, etc.</li>
            <li><strong>Filière/Groupe :</strong> selon l'organisation pédagogique en vigueur</li>
            <li><strong>Intitulé du cours Coursera :</strong> préciser le nom exact du cours ou du parcours certifiant</li>
            <li><strong>Causes de non-obtention :</strong> problèmes techniques, difficultés, absence de remise des évaluations, etc.</li>
            <li><strong>Actions préconisées :</strong> accompagnement, rappel deadlines, tutorat, etc.</li>
        </ul>
    </div>

    <div class="info-section">
        <div class="info-card">
            <h3>Enseignant responsable</h3>
            <p><strong>Nom :</strong> [Nom du responsable]</p>
            <p><strong>Email :</strong> [email@itbs.ma]</p>
            <p><strong>Date de mise à jour :</strong> <span id="currentDate"></span></p>
        </div>
        <div class="info-card">
            <h3>Légende des statuts</h3>
            <p><span class="status-obtenu">■</span> <strong>Obtenu :</strong> Certification délivrée</p>
            <p><span class="status-encours">■</span> <strong>En cours :</strong> Cours en progression</p>
            <p><span class="status-nonobtenu">■</span> <strong>Non obtenu :</strong> Certification non acquise</p>
        </div>
    </div>

    <table id="suiviTable">
        <thead>
            <tr>
                <th>N°</th>
                <th>Nom et Prénom</th>
                <th>Niveau</th>
                <th>Filière</th>
                <th>Groupe</th>
                <th>Cours Coursera</th>
                <th>Statut</th>
                <th>Date d'obtention</th>
                <th>Causes de non-obtention</th>
                <th>Actions préconisées</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td><input type="text" id="nom_prenom" placeholder="Nom Prénom"></td>
                <td><input type="text" id="niveau" placeholder="L1, L2..."></td>
                <td><input type="text" id="filiere" placeholder="Filière"></td>
                <td><input type="text" id="groupe" placeholder="Groupe"></td>
                <td><input type="text" id="cours" placeholder="Intitulé du cours"></td>
                <td>
                    <select id="statut" class="status-select">
                        <option value="">Sélectionner</option>
                        <option value="obtenu" class="status-obtenu">Obtenu</option>
                        <option value="encours" class="status-encours">En cours</option>
                        <option value="nonobtenu" class="status-nonobtenu">Non obtenu</option>
                    </select>
                </td>
                <td><input type="date" id="date_obtention"></td>
                <td><textarea id="causes" placeholder="Si non obtenu..."></textarea></td>
                <td><textarea id="actions" placeholder="Actions à prendre..."></textarea></td>
            </tr>
        </tbody>
    </table>

    <div class="btn-container">
        <button id="sendBtn">Envoyer</button>
        <button id="resetBtn">Réinitialiser</button>
    </div>

    <div class="footer">
        <p>Merci de retourner ce document complété avant la date limite.</p>
    </div>
</div>

<script>
document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fr-FR');

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwJOypQKC1FKYhm-cDeAnJXVB31muI7wbBfPeBW9Mwpq2ABHipWPEUpA3abpBIcdUuHMA/exec"; // remplace par ton URL Apps Script

// Envoi unique
document.getElementById('sendBtn').addEventListener('click', async function(){
    const data = {
        nom_prenom: document.getElementById('nom_prenom').value,
        niveau: document.getElementById('niveau').value,
        filiere: document.getElementById('filiere').value,
        groupe: document.getElementById('groupe').value,
        cours: document.getElementById('cours').value,
        statut: document.getElementById('statut').value,
        date_obtention: document.getElementById('date_obtention').value,
        causes: document.getElementById('causes').value,
        actions: document.getElementById('actions').value
    };

    try {
        const res = await fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(data),
            headers: { 'Content-Type': 'application/json' }
        });
        const json = await res.json();
        alert("Données envoyées avec succès : " + json.message);
    } catch(err) {
        console.error(err);
        alert("Erreur lors de l'envoi : " + err);
    }
});

// Réinitialiser
document.getElementById('resetBtn').addEventListener('click', function(){
    if(confirm("Voulez-vous vraiment réinitialiser toutes les données ?")){
        document.querySelectorAll('input, select, textarea').forEach(el=>{
            if(el.tagName==="SELECT") el.selectedIndex=0; else el.value="";
        });
    }
});

// Changer couleur du statut
document.getElementById('statut').addEventListener('change', function(){
    this.className='status-select ' + this.value;
});
</script>
</body>
</html>
